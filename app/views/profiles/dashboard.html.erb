
<div id="white">

<!-- Main -->
<div class="container">
    <div class="row">
    <div class="centered">
    	<h1>Dashboard</h1>
    </div>

        <div class="col-md-12">

            <!-- column 2 -->
            <ul class="list-inline pull-right">
                <li><a href="#"><i class="glyphicon glyphicon-cog"></i></a></li>
                <li class="dropdown"><a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="glyphicon glyphicon-comment"></i><span class="count">3</span></a>
                    <ul class="dropdown-menu" role="menu">
                        <li><a href="#">1. Is there a way..</a></li>
                        <li><a href="#">2. Hello, admin. I would..</a></li>
                        <li><a href="#"><strong>All messages</strong></a></li>
                    </ul>
                </li>
                <li><a href="#"><i class="glyphicon glyphicon-user"></i></a></li>
                <li><a title="Add Widget" data-toggle="modal" href="#addWidgetModal"><span class="glyphicon glyphicon-plus-sign"></span> Add Widget</a></li>
            </ul>
            <hr>

            <div class="row">
                <!-- center left-->
                <div class="col-md-4">

                	<div class="centered"><h1> <%= @profile.user.email %></h1></div>
                    <div class="well">Inbox Messages <span class="badge pull-right">3</span></div>

                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h4>My Spaces</h4></div>
                        <div class="panel-body">
                        	<div class="list-group">

                        		<% @spaces.each do |space| %>

									<div class="list-group-item"><%= link_to space.name, space_path(space) %>
<<<<<<< HEAD
									<span class="badge pull-right"><%= space.requests.where(status: 0).count %> requests</span>
						
									</div>
					
=======
									<span class="badge pull-right"><%= space.requests.where(status: 0).count %> requests</span></div>

>>>>>>> 2123e56d5f8dcccdff57ba8f7f8c447d056afbb5
								<% end %>
								<%= link_to "Add New Space", new_space_path, class: "list-group-item" %>

                            </div>
	                            <div class="centered"><%= link_to "See All Spaces", spaces_myspaces_path %></div>
                        </div>
                        <!--/panel-body-->
                    </div>
                    <!--/panel-->

                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h4>My Events</h4></div>
                        <div class="panel-body">
                        	<div class="list-group">

                        		<% @events.each do |event| %>

									<div class="list-group-item"><%= link_to event.name, event_path(event) %></div>

								<% end %>
								<%= link_to "Add New Event", new_event_path, class: "list-group-item" %>

                            </div>
	                            <div class="centered"><%= link_to "See All Events *edit this to my spaces*", events_path %></div>
                        </div>
                        <!--/panel-body-->
                    </div>
                    <!--/panel-->




                </div>
                <!--/col-->
                <div class="col-md-8">


                    <div class="panel panel-default">
                        <div class="panel-body">
                            <div class="col-xs-4 text-center">
                            	<h1><i class="glyphicon glyphicon-signal"></i><br>
	                            	<% @past_events.each do |event| %>
											<% @current_earnings += event.space.price %>
									<% end %>
									$<%= @current_earnings %>
									</h1>
								<small>Earnings to Date</small>
                            </div>
                            <div class="col-xs-4 text-center">
                            	<h1><i class="glyphicon glyphicon-star"></i><br>
                            	<% if @most_popular_space.present? %>
                            		<%= truncate(@most_popular_space.name, :length => 6) %> 
                            	<% else %>
                            		N/A
                            	<% end %>
                            	</h1>

                            	<small>Most Popular Space</small>
                            </div>
                            <div class="col-xs-4 text-center">
                            	<h1><i class="glyphicon glyphicon-bullhorn"></i><br>
                            		<% if @upcoming_events.present? %>
                            		<%= @upcoming_events.count %>
                            		<% else %>
                            		N/A
                            		<% end %></h1>
                            	<small>Upcoming Events</small>
                            	</div>
                           

                        </div>
                    </div>

                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h4>Requests</h4></div>
                        <div class="panel-body">
                            <div class="alert alert-info">
                                <button type="button" class="close" data-dismiss="alert">Ã—</button>
                                You have <%= @requests.unanswered.count %> unanswered requests!
                            </div>
                            <p>
                            	<table class="table table-hover">
				    <thead>
				      <tr>
				        <th>From</th>
				        <th>Event</th>
				        <th>Your Space</th>
				        <th>Request Message</th>
				        <th>Status</th>
				      </tr>
				    </thead>
				    <tbody>
				<% @requests.last(5).each do |request| %>
				      <tr>
				        <td><%= request.event.user.email %></td>
				        <td><%= link_to request.event.name, event_path(request.event) %></td>
				        <td><%= link_to request.space.name, space_path(request.space) %></td>
				        <td><%= request.body %></td>
				        <td>
					        	<% if request.unanswered? %>
								<%= link_to '<i class="glyphicon glyphicon-ok"></i>'.html_safe, confirm_request_path(request), data: { confirm: "Are you sure you want to confirm this request? " }, class: "btn btn-primary btn-sm btn-success" %>
								<%= link_to '<i class="glyphicon glyphicon-remove"></i>'.html_safe, deny_request_path(request), data: { confirm: "Are you sure you want to deny this request? " }, class: "btn btn-primary btn-danger btn-sm" %>
								<% elsif request.confirmed? %>
									<i class="glyphicon glyphicon-ok"></i>
								<% else %>
									<i class="glyphicon glyphicon-remove"></i>
								<% end %>
				        </td>
				      </tr>
				 <% end %>
				    </tbody>
				    <tfoot>
				    <tr>
				    	<th colspan=5 style="text-align:center"><%= link_to "See All Requests", requests_path %></th>
				    </tr>
				    </tfoot>

				  </table>

                            </p>



                        </div>
                    </div>
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h4>Messages 
                            <span class="badge">
                            <% if @unread > 0 %>
						 		<%= @unread %> New
						 	<% else %>
						 		0 New
						<% end %> </span></h4></div>
                        <div class="panel-body">

                        	<table class="table table-hover">
				    <thead>
				      <tr>
				        <th>Sender</th>
				        <th>Subject</th>
				        <th>Date</th>
				      </tr>
				    </thead>
				    <tbody>
				<% @messages.first(5).each do |message| %>
				      <tr>
				        <td>
				        <% if message.unread %><b><% end %>
				        <% if message.sender == nil %>
							Admin
						<% else %>
							<%= message.sender.email %>
						<% end %>
						</td>
				        <td><% if message.unread %><b><% end %>
				        <%= link_to message.subject, message_path(message) %></td>
				        <td><% if message.unread %><b><% end %>
				        <%= message.created_at.to_date %></b></td>

				      </tr>
				 <% end %>

				    </tbody>
				    <tfoot>
				    <tr>
				    	<th colspan=4 style="text-align:center"><%= link_to "See All Messages", messages_path %></th>
				    </tr>
				    </tfoot>
				   </table>

                        </div>
                    </div>
                    <div class="table-responsive">
                        <table class="table table-striped">


                        </table>
                    </div>
     


                </div>
                <!--/col-span-6-->

            </div>
            <!--/row-->

        </div>
        <!--/col-span-9-->
    </div>
</div>





	<div class="container">
    <div class="col-lg-12 centered">
			<h1>Dash</h1>
			<p>Email: <%= @profile.user.email %>
			</br>


			<!-- Cool bar at top of dash thingy -->

			<!-- Earnings to Date -->
			<p>Earnings to Date:
				<% @past_events.each do |event| %>
					$<% @current_earnings += event.space.price %>
				<% end %>
				<%= @current_earnings %>
			</p>

			<!-- Most Popular Space -->
			<% unless @most_popular_space == nil %>
				<p>Most Popular Space: <%= @most_popular_space.name %></p>
			<% end %>

			<!-- Upcoming Events -->
			<p>Upcoming Events: <%= @upcoming_events.count %></p>

			<!-- Total Requests -->
			<p>Pending Requests: <%= @profile.user.space_requests.count %> </p>

			<!-- Spaces -->
			<div class="row">
				<div class="col-md-4"><h3>My Spaces</h3></div>
			</div>
			<div class="row">
				<div class="col-md-2">Space:</div>
				<div class="col-md-2">Number of Requests:</div>
			</div>
			<% @spaces.each do |space| %>
				<div class="row">
					<div class="col-md-2"><%= space.name %></div>
					<div class="col-md-2"><%= space.requests.where(status: 0).count %></div>
				</div>
			<% end %>
			<br><br>


			<!-- Events -->
			<div class="row">
				<div class="col-md-4"><h3>My Events</h3></div>
			</div>
			<div class="row">
				<div class="col-md-2">Event:</div>
				<div class="col-md-2">Number of Requests:</div>
			</div>
			<% @events.each do |event| %>
				<div class="row">
					<div class="col-md-2"><%= event.name %></div>
					<div class="col-md-2"><%= event.requests.count %></div>
				</div>
			<% end %>
			<br><br>


			<!-- Requests -->
			<div class="row">
				<div class="col-md-8 col-md-offset-4"><h3>Requests</h3></div>
			</div>
			<div class="row">
				<div class="col-md-2 col-md-offset-4">Requester:</div>
				<div class="col-md-4">Space Requested:</div>
			</div>
			<% @requests.each do |request| %>
				<div class="row">
					<div class="col-md-2 col-md-offset-4"><%= request.event.user.profile.first_name.capitalize %></div>
					<div class="col-md-4"><%= request.space.name %></div>
					<div class="col-md-2"><%= link_to "View", requests_path %></div>
				</div>
			<% end %>
			<div class="row">
					<div class="col-md-2 col-md-offset-4"><%= link_to "See all", requests_path %></div>
			</div>


			<!-- Messages -->
			<div class="row">
				<div class="col-md-8 col-md-offset-4">
					<h3>
						Messages
						<% if @unread > 0 %>
						 (Unread: <%= @unread %>)
						<% end %>
					</h3>
				</div>
			</div>
			<div class="row">
				<div class="col-md-2 col-md-offset-4">Sender:</div>
				<div class="col-md-4">Subject:</div>
			</div>
			<% @messages.each do |message| %>
				<div class="row">
					<% if message.unread %><b><% end %>
					<div class="col-md-2 col-md-offset-4"><%= message.sender.profile.name.capitalize %></div>
					<div class="col-md-4"><%= message.subject %></div>
					<div class="col-md-2"><%= link_to "View", message_path(message) %></div>
					<% if message.unread %></b><% end %>
				</div>
			<% end %>
			<div class="row">
					<div class="col-md-2 col-md-offset-4"><%= link_to "See all", messages_path %></div>
			</div>

		</div>
	</div>
</div>